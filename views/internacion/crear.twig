{% extends "layout.twig" %}

{% block content %}

	<div class="crear_internacion">

		{% set tituloAction = 'Agregar' %}
		{% set formAction = 'save' %}	
		{% set submitValue = 'Siguiente' %}		

		{% if isEdit %}

			{% set tituloAction = 'Editar' %}
			{% set formAction = 'saveEdit' %}
			{% set submitValue = 'Modificar' %}		

			{% set id_internacionValue = internacion.id %}
			{% set id_pacienteValue = internacion.idPaciente %}
			{% set nom_pacienteValue = internacion.nombre %}
			{% set fechaIngValue = internacion.fechaIngreso|date("Y-m-d\\TH:i:s") %}
			{% set fechaEgrValue = internacion.fechaEgreso|date("Y-m-d\\TH:i:s") %}
		
		{% endif %} 

		
		{% if camposIngresados %}

			{% set id_pacienteValue = camposIngresados.id_paciente %}
			{% set nom_pacienteValue = camposIngresados.nom_paciente %}
			{% set fechaIngValue = camposIngresados.fechaIng %}
			{% set fechaEgrValue = camposIngresados.fechaEgr %}

		{% endif %} 

		
		<h4>{{ tituloAction }} Internacion</h4>

		{% if responseMessage %}
			
			<div class="alert alert-primary"role="alert">

				{{ responseMessage }}

			</div>

		{% endif %} 
	
			<form action="{{ formAction }}" method="post">

				<div class="form-group">

					<input type="hidden" name="id_internacion" id="id_internacion" class="form-control" value="{{ id_internacionValue }}">

					<input type="hidden" name="id_paciente" id="id_paciente" class="form-control" value="{{id_pacienteValue}}">

					<label for="paciente">Paciente</label>
					
					<div class="input-group">

						<input type="text" name="nom_paciente" id="nom_paciente" class="form-control" value="{{nom_pacienteValue}}" readonly>

						<div class="input-group-append">
						
							<button class="btn btn-outline-secondary" type="button" data-toggle="modal" data-target="#modalAddPaciente" id="btnSeleccionar">Seleccionar</button>
					
						</div>
			
					</div>

				</div>

				<div class="form-group">
					<label for="fechaIng">Fecha ingreso</label>
					<input type="datetime-local" name="fechaIng" id="fechaIng" class="form-control" value="{{fechaIngValue}}">
				</div>

				<div class="form-group">
					<label for="fechaEgr">Fecha Egreso</label>
					<input type="datetime-local" name="fechaEgr" id="fechaEgr" class="form-control" value="{{fechaEgrValue}}">
				</div>
			
				<input type="submit" value="{{ submitValue }}" class="btn btn-primary">	

				<a href="/fuerarango/">
					<button type="button" class="btn btn-secondary">Cancelar</button>
				</a>

			</form>
	</div>

<div class="modal fade-lg" id="modalAddPaciente" tabindex="-1" role="dialog" aria-labelledby="modalAddPaciente" aria-hidden="true">

	<div class="modal-dialog-lg">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">
					Seleccionar paciente
				</h5>
				<button class="close" data-dismiss="modal" aria-label="Cerrar">
					<span aria-hidden="true">&times;</span>
				</button>
			</div>

			<input type="text" class="form-control buscador" id="buscador" placeholder="Buscar afiliado">

			<div class="modal-body">

				<table class="table" id="allPacientes">

					<thead>
						<tr>
							<th></th>
							<th>Beneficio</th>
							<th>Nombre</th>
							<th>DNI</th>

						</tr>
					</thead>

					<tbody>

						{% for paciente in pacientes %}

							<tr>
								<td>
									<button type="button" class="btn btn-primary btn-paciente" value="{{paciente.idPaciente}}" name="{{paciente.nombre}}">Seleccionar</button>
								</td>
								<td>{{paciente.beneficio}}</td>
								<td>{{paciente.nombre}}</td>
								<td>{{paciente.dni}}</td>

							</tr>

						{% endfor %}

					</tbody>

				</table>


			</div>
		</div>

	</div>

{% endblock %}

{% block javascript %}

	<script src="{{base_url}}js/internacion.js"></script>

{% endblock %}
